<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soil Analysis & Crop Recommendation</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <div class="container">
            <h1>FarmHelp: Soil Analysis & Crop Recommendation</h1>
            <nav>
                <ul>
                    <li><a href="/" class="active">Home</a></li>
                    <li><a href="/about">About</a></li>
                    {% if session.user_id %}
                        <li><a href="/logout">Logout ({{ session.user_name }})</a></li>
                    {% else %}
                        <li><a href="/login">Login</a></li>
                        <li><a href="/register">Register</a></li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </header>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-messages">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <main>
        <div class="container">
            <section class="welcome">
                <h2>Welcome to FarmHelp</h2>
                <p>Enter your soil parameters below to get personalized crop recommendations and fertilizer advice.</p>
            </section>

            <section class="form-section">
                <div id="error-message" class="alert alert-error hidden" style="display: none;"></div>
                {% if session.user_id %}
                <form id="soil-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="nitrogen">Nitrogen (N)</label>
                            <input type="number" id="nitrogen" name="nitrogen" min="0" max="140" required>
                            <span class="input-hint">Range: 0-140</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="phosphorus">Phosphorus (P)</label>
                            <input type="number" id="phosphorus" name="phosphorus" min="0" max="140" required>
                            <span class="input-hint">Range: 0-140</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="potassium">Potassium (K)</label>
                            <input type="number" id="potassium" name="potassium" min="0" max="140" required>
                            <span class="input-hint">Range: 0-140</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="temperature">Temperature (¬∞C)</label>
                            <input type="number" id="temperature" name="temperature" min="0" max="50" required>
                            <span class="input-hint">Range: 0-50¬∞C</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="humidity">Humidity (%)</label>
                            <input type="number" id="humidity" name="humidity" min="0" max="100" required>
                            <span class="input-hint">Range: 0-100%</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="ph">pH Level</label>
                            <input type="number" id="ph" name="ph" min="0" max="14" step="0.1" required>
                            <span class="input-hint">Range: 0-14</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="rainfall">Rainfall (mm)</label>
                            <input type="number" id="rainfall" name="rainfall" min="0" max="300" required>
                            <span class="input-hint">Range: 0-300mm</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="region">Region</label>
                            <select id="region" name="region" required>
                                <option value="" disabled selected>Select your region</option>
                                <option value="Western Maharashtra">Western Maharashtra</option>
                                <option value="Khandesh/North Maharashtra">Khandesh/North Maharashtra</option>
                                <option value="Vidarbha">Vidarbha</option>
                                <option value="Marathwada">Marathwada</option>
                                <option value="Konkan">Konkan</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Get Recommendation</button>
                        <button type="reset" class="btn-secondary">Reset</button>
                    </div>
                </form>
                {% else %}
                <!-- Overview for logged-out users -->
                <section class="hero">
                    <div class="hero-content">
                        <h2>Smart Soil Analysis & Crop Recommendations</h2>
                        <p>Unlock data-driven insights for better yields. FarmHelp analyzes your soil inputs and recommends the best crops, fertilizers, and tips tailored to Maharashtra's regions.</p>
                        <div class="hero-actions">
                            <a href="/about" class="btn-primary">Learn More</a>
                            <a href="/register" class="btn-secondary">Get Started</a>
                        </div>
                    </div>
                    <div class="hero-art" aria-hidden="true"></div>
                </section>

                <section class="features">
                    <h3 class="section-title">Why FarmHelp?</h3>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">üå±</div>
                            <h4>Personalized Crops</h4>
                            <p>Recommendations aligned with your soil's NPK, pH, and climate.</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">üß™</div>
                            <h4>Fertilizer Guidance</h4>
                            <p>Actionable suggestions to optimize nutrients and inputs.</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">üìç</div>
                            <h4>Region Aware</h4>
                            <p>Tailored to Western Maharashtra, Khandesh, Vidarbha, Marathwada, and Konkan.</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">‚ö°</div>
                            <h4>Fast & Simple</h4>
                            <p>Enter a few values and get instant, easy-to-read insights.</p>
                        </div>
                    </div>
                </section>

                <section class="how-it-works">
                    <h3 class="section-title">How it works</h3>
                    <div class="steps">
                        <div class="step">
                            <span class="step-num">1</span>
                            <h4>Create an account</h4>
                            <p>Register to unlock the soil analysis form and save your insights.</p>
                        </div>
                        <div class="step">
                            <span class="step-num">2</span>
                            <h4>Enter soil details</h4>
                            <p>Provide N, P, K, pH, temperature, humidity, rainfall, and region.</p>
                        </div>
                        <div class="step">
                            <span class="step-num">3</span>
                            <h4>Get recommendations</h4>
                            <p>Receive crops, fertilizers, and tips tailored to your conditions.</p>
                        </div>
                    </div>
                </section>
                {% endif %}
            </section>

            <section id="results" class="results-section hidden">
                <h2>Your Recommendation</h2>
                <div class="loader hidden"></div>
                <div class="results-content">
                    <div class="result-card">
                        <h3>Recommended Crop</h3>
                        <p id="crop-name" class="highlight">-</p>
                        <p id="crop-description">-</p>
                    </div>
                    
                    <div class="result-card">
                        <h3>Recommended Fertilizers</h3>
                        <ul id="fertilizers-list">
                            <li>-</li>
                        </ul>
                    </div>
                    
                    <div class="result-card">
                        <h3>Farming Tips</h3>
                        <p id="farming-tips">-</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 FarmHelp - Soil Analysis & Crop Recommendation</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>